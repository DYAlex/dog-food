# Dog Food Проект в рамках курсах обучения Фронтенд разработки в СберУниверситете

## Использованные технологии

1. [Create React App](https://github.com/facebook/create-react-app).
2. [Classnames](https://www.npmjs.com/package/classnames).
1. [React Router](https://reactrouter.com/en/main).
1. [Formik](https://formik.org/).
1. [TanStack Query v4](https://tanstack.com/query/latest).
1. [Redux](https://redux.js.org/).
1. [Redux Toolkit](https://redux-toolkit.js.org/).
1. [Font Awesome](https://fontawesome.com/).
1. [SASS](https://www.npmjs.com/package/sass).

### Available Scripts

In the project directory, you can run:

#### `npm start`

Runs the app in the development mode.\
Open [http://localhost:3000](http://localhost:3000) to view it in your browser.

The page will reload when you make changes.\
You may also see any lint errors in the console.

## API 

API предоставлен обучающей организацией

## Приоритеты 

+ [CRITICAL] - Необходимый функционал проекта или блокирующие его баги
+ [HIGH] - Второстепенный функционал проекта или баги, которые выявлены в его реализации
+ [MIDDLE] - Дополнительный функционал проекта и сопутствующие баги
+ [LOW] - Опциональный функционал и сопутствующие баги
+ [DONE] - Работы временно не ведутся


## Основной функционал проекта

+ Регистрация на сайте. Страница регистрации «/signup». Форма реализована через Formik (валидация через yup). После успешного ответа сервера перенаправляем пользователя на страницу аутентификации.

+ Аутентификация на сайте. Страница аутентификации «/signin». Форма реализована через Formik (валидация через yup). После успешного ответа сохраняем токен в состояние Redux. Пользователь остается авторизованными до момента нажатия на кнопку "Выйти". 

+ Настроена синхронизация Redux с LocalStorage

+ Главная страница-заглушка «/» со ссылками на Каталог и Личный кабинет

+ Страница отображения списка товаров «/products». Если пользователь не авторизован, то перенаправляем его на страницу аутентификации. Если пользователь авторизован, то получаем данные с сервера и отрисовываем карточки товаров. Здесь также реализован механизм отображения компонента Loader, чтобы информировать пользователя о сетевом запросе.

+ Реализован поиск товаров на главной странице с оптимизацией через debounce.

+ Реализована страница "Корзина": 
  1) Добавление товара в корзину происходит путем клика на кнопку "В корзину" в карточке товара на странице списка
  2) Количество товаров в корзине отображается рядом с иконкой в шапке сайта. Эта цифра отвечает за уникальные товары в корзине.
  3) В корзине отображается каждый товар на своей строчке (название товара, фото товара, количество, цена). За образец взяли реализацию корзины в сетевом магазине DNS.
  4) Реализован функционал изменения количества конкретного товара. Минимум 1 шт, максимум берем из поля "stock" у товара. При достижении границ, кнопки убавления/прибавления становятся неактивными.
  5) Реализована возможность удалить выбранный товар из корзины.
  6) Реализована возможность выбора товаров в корзине, которые пользователь будет оформлять. Логика такая, что в корзине могут находится десятки товаров, но пользователь может выбрать, например, только 2 товара, которые хочет оформить. 
  7) Реализован подсчет стоимости выбранных товаров (с учетом скидок) и выводим кнопку-пустышку "Оформить".
  8) Реализована информационная заглушка на детальной корзины, если в корзине нет товаров. "Здесь пока ничего нет" и ссылки на страницы Каталог, Личный кабинет.
  9) Добавлено модальное окно с подтверждением удаления товара из корзины

+ Реализована Детальная страница товара
  1) Загружаем информацию о товаре через TanStack. Id товара достаем через useParams
  2) Реализована возможность добавить товар в корзину.
  3) Реализовано отображение комментариев с получением имени автора по id
  4) Реализована возможность добавить товар в избранное в Redux.
  5) Реализовано добавление комментариев (форма создания нового комментария располагается над комментариями)
  6) Реализована возможность удаления товара. Кнопка удаления есть только у автора.
  7) Реализовано редактирование товара (Форма через Formik. Валидация через yup. Запрос через мутации TanStack). Кнопка редактирования есть только у автора товара.
  8) Реализована возможность удаления собственных комментариев

+ Реализована страница с информацией о пользователе (имя, доп. информация, фото, группа, email)

+ Реализована страница Избранное, на которой выводится список товаров из слайса favorites Redux.

+ Реализована сортировка товаров на странице '/products' с сохранением параметров сортировки в url (По цене, по акции, по дате добавления)

+ Добавлена сортировка по популярности исходя из среднего рейтинга в отзывах к товару.

+ Реализовано добавление нового товара. Форма через Formik. Валидация через yup. Запрос через мутации TanStack. После создания переадресация на страницу вновь созданного товара.

+ Реализована возможность редактировать информацию и аватар пользователя в Личном кабинете.


## План развития проекта
-------------------------

### Опциональные изменения 
1. [DONE] Переделать оставшиеся недоделанными кнопки в отдельные компоненты, которые используют модульный css. (кнопки В корзину, Подробнее, Закрыть, Оформить и др.)
2. [DONE] Создать ещё папку "pages" и перекинуть в неё большие компоненты. Тогда в "common" будут атомы, а в "pages" большие страницы.
3. [MIDDLE] Реализовать синхронизацию с локальным хранилищем корзин для нескольких пользователей.
4. [LOW] Реализовать кнопку скрытия/показа пароля в инпутах форм.
5. [LOW] Добавить анимации переходов между страницами
6. [LOW] Добавить анимации кнопок при наведении на них указателя.
8. [LOW] Добавить в карточку продукта в каталоге цену со скидкой.
9. [LOW] Добавить в Личный кабинет список созданных товаров и написанных отзывов. 

## Устраненные баги
+ [DONE] Эффект моргания страницы при удалении продукта из корзины.
+ [DONE] При удалении товара в консоли появляется предупреждение: Cannot update a component (`RouterProvider`) while rendering a different component (`DeleteProductModal`). To locate the bad setState() call inside `DeleteProductModal`, follow the stack trace as described in https://reactjs.org/link/setstate-in-render
    at DeleteProductModal (http://localhost:3000/dog-food/static/js/bundle.js:4113:5). Скорее всего, из-за того что модальное окно рендерится через страницу товара, который мы удаляем, и в результате удачного удаления модалка не может поменять свое состояние.
+ [DONE] При редактировании товара в консоли появляется предупреждение: Warning: Cannot update a component (`ProductDetailInner`) while rendering a different component (`EditProductModal`). To locate the bad setState() call inside `EditProductModal`, follow the stack trace as described in https://reactjs.org/link/setstate-in-render
    at EditProductModal (http://localhost:3000/dog-food/static/js/bundle.js:4315:5)
+ [DONE] При редактировании информации и аватара в консоли появляется предупреждение: Warning: Cannot update a component... В лучших традициях закрытия модального окна по действию.  
+ [DONE] При удалении карточки товара, находящегося у пользователя в корзине или в избранном, страницы корзины и избранного перестают отображаться. Для решения проблемы был переработан механизм рендеринга в компонентах Cart и Favorites, в них добавлены дополнительные проверки и введен новый компонент ErrorItem, который рендерит карточку удаленного товара и отображает кнопки, дающие возможность пользователям удалить такой товар из своих корзин и избранного. 

## Известные баги

- [LOW] Хедер не реагирует на изменение ширины вьюпорта. Предполагаемые шаги к устранению: завести состояние, чтобы Реакт реагировал на изменение ширины. 
- [LOW] Футер не реагирует на изменение ширины вьюпорта. Предполагаемые шаги к устранению: завести состояние, чтобы Реакт реагировал на изменение ширины. С учетом того, что у нас уже два компонента, которые этого требуют возможно правильнее использовать контекст для отслеживания ширины вьюпорта, а в компонентах только получать и использовать результат.
- [HIGH] После сохранения в локальном хранилище корзины одного пользователя, при входе на сайт с того же устройства другого пользователя может подгружаться корзина первого пользователя.
- [LOW] В формах регистрации и входа плывет верстка при выведении ошибок.
